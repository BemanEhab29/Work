<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Work Hours & Salary Tracker</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f4f4f4; }
    h1 { text-align: center; }
    .container { max-width: 950px; margin: auto; background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 10px; }
    input, button { margin-top: 5px; padding: 8px; font-size: 14px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    table, th, td { border: 1px solid #ccc; }
    th, td { padding: 8px; text-align: center; }
    th { background: #eee; }
    tr.total-row { font-weight: bold; background: #f0f8ff; }
    .btn-delete { color: red; cursor: pointer; border: none; background: none; font-weight: bold; }
    .btn-clear { margin-top: 10px; background: red; color: #fff; padding: 5px 10px; border: none; cursor: pointer; border-radius: 5px; }
    .holiday-row { background: #ffebcc; }
    .saturday-row { background: #cce5ff; }
    .friday-row { background: #d9d9d9; font-style: italic; }
  </style>
</head>
<body>
<div class="container">
  <h1>Work Hours & Salary Tracker</h1>

  <label>Hourly Rate:
    <input type="number" id="hourlyRate" placeholder="Enter hourly rate">
    <button onclick="saveHourlyRate()">Save Rate</button>
  </label>

  <label>Date:
    <input type="date" id="workDate">
  </label>

  <label>
    <input type="checkbox" id="holiday"> National Holiday
  </label>
  
  <label>
    <input type="checkbox" id="fridayOff"> Friday Off
  </label>

  <label>Start Time:
    <input type="time" id="startTime">
  </label>
  <label>End Time:
    <input type="time" id="endTime">
  </label>
  <label>Break (minutes):
    <input type="number" id="breakMinutes" value="0">
  </label>

  <button onclick="addEntry()">Add Entry</button>
  <button class="btn-clear" onclick="clearAllEntries()">Clear All Entries</button>

  <table id="logTable">
    <thead>
      <tr>
        <th>Date</th>
        <th>Worked Hours</th>
        <th>Regular Hours</th>
        <th>Overtime Hours</th>
        <th>Saturday Hours</th>
        <th>Deduction</th>
        <th>Daily Pay</th>
        <th>Action</th>
      </tr>
    </thead>
    <tbody id="logBody"></tbody>
    <tfoot>
      <tr class="total-row">
        <td>TOTAL</td>
        <td id="totalWorked">0</td>
        <td id="totalRegular">0</td>
        <td id="totalOvertime">0</td>
        <td id="totalSaturday">0</td>
        <td id="totalDeduction">0</td>
        <td id="totalPay">0</td>
        <td></td>
      </tr>
    </tfoot>
  </table>
</div>

<script>
let hourlyRate = localStorage.getItem("hourlyRate") || 0;
document.getElementById("hourlyRate").value = hourlyRate;
let log = JSON.parse(localStorage.getItem("workLog") || "[]");

function saveHourlyRate() {
  hourlyRate = document.getElementById("hourlyRate").value;
  localStorage.setItem("hourlyRate", hourlyRate);
  alert("Hourly rate saved!");
}

function calculateDeduction(startTime) {
  if (!startTime) return 0;
  const [h, m] = startTime.split(":").map(Number);
  const minutes = h * 60 + m;
  if (minutes <= 540) return 0;
  if (minutes <= 555) return -1 * hourlyRate;
  if (minutes <= 570) return -2 * hourlyRate;
  if (minutes <= 600) return -4 * hourlyRate;
  return -8 * hourlyRate;
}

function formatDate(dateStr) {
  const d = new Date(dateStr);
  return String(d.getDate()).padStart(2,'0') + "/" +
         String(d.getMonth()+1).padStart(2,'0') + "/" +
         d.getFullYear();
}

function addEntry() {
  const date = document.getElementById("workDate").value;
  const holiday = document.getElementById("holiday").checked;
  const fridayOff = document.getElementById("fridayOff").checked;
  const start = document.getElementById("startTime").value;
  const end = document.getElementById("endTime").value;
  const breakMinutes = parseInt(document.getElementById("breakMinutes").value) || 0;

  if(!date){ alert("Please select a date"); return; }

  const day = new Date(date).getDay(); // 0=Sun, 5=Fri, 6=Sat
  let worked=0, regular=0, overtime=0, saturdayHrs=0, deduction=0, pay=0, type="normal";

  if(fridayOff){
    type="friday";
  } else if(holiday){
    worked=8; regular=8; pay=8*hourlyRate; type="holiday";
  } else if(day===6){ // Saturday
    if(!start||!end){ alert("Enter start and end time"); return; }
    const st=new Date(`1970-01-01T${start}:00`);
    const et=new Date(`1970-01-01T${end}:00`);
    worked=(et-st)/3600000-(breakMinutes/60);
    saturdayHrs=worked;
    pay=worked*hourlyRate*2;
    type="saturday";
  } else {
    if(!start||!end){ alert("Enter start and end time"); return; }
    const st=new Date(`1970-01-01T${start}:00`);
    const et=new Date(`1970-01-01T${end}:00`);
    worked=(et-st)/3600000-(breakMinutes/60);

    regular=Math.min(8,worked);
    overtime=worked>8?worked-8:0;
    deduction=calculateDeduction(start);

    pay=(regular*hourlyRate)+(overtime*hourlyRate*1.5)+deduction;
  }

  const formattedDate = formatDate(date);
  const entry = { date:formattedDate, worked, regular, overtime, saturdayHrs, deduction, pay, type };
  log.push(entry);
  localStorage.setItem("workLog", JSON.stringify(log));
  renderLog();
}

function deleteEntry(index){
  if(confirm("Are you sure you want to delete this entry?")){
    log.splice(index,1);
    localStorage.setItem("workLog", JSON.stringify(log));
    renderLog();
  }
}

function clearAllEntries(){
  if(confirm("Are you sure you want to clear all entries?")){
    log = [];
    localStorage.setItem("workLog", JSON.stringify(log));
    renderLog();
  }
}

function renderLog(){
  const tbody=document.getElementById("logBody");
  tbody.innerHTML="";
  let totals={worked:0, regular:0, overtime:0, saturday:0, deduction:0, pay:0};

  log.forEach((entry,index)=>{
    totals.worked+=entry.worked;
    totals.regular+=entry.regular;
    totals.overtime+=entry.overtime;
    totals.saturday+=entry.saturdayHrs;
    totals.deduction+=entry.deduction;
    totals.pay+=entry.pay;

    let row="";
    if(entry.type==="friday"){
      row=`<tr class="friday-row">
        <td>${entry.date}</td>
        <td colspan="6">Friday</td>
        <td><button class="btn-delete" onclick="deleteEntry(${index})">Delete</button></td>
      </tr>`;
    } else if(entry.type==="holiday"){
      row=`<tr class="holiday-row">
        <td>${entry.date}</td>
        <td>${entry.worked.toFixed(2)}</td>
        <td>${entry.regular.toFixed(2)}</td>
        <td>${entry.overtime.toFixed(2)}</td>
        <td>${entry.saturdayHrs.toFixed(2)}</td>
        <td>${entry.deduction.toFixed(2)}</td>
        <td>${entry.pay.toFixed(2)}</td>
        <td><button class="btn-delete" onclick="deleteEntry(${index})">Delete</button></td>
      </tr>`;
    } else if(entry.type==="saturday"){
      row=`<tr class="saturday-row">
        <td>${entry.date}</td>
        <td>${entry.worked.toFixed(2)}</td>
        <td>${entry.regular.toFixed(2)}</td>
        <td>${entry.overtime.toFixed(2)}</td>
        <td>${entry.saturdayHrs.toFixed(2)}</td>
        <td>${entry.deduction.toFixed(2)}</td>
        <td>${entry.pay.toFixed(2)}</td>
        <td><button class="btn-delete" onclick="deleteEntry(${index})">Delete</button></td>
      </tr>`;
    } else {
      row=`<tr>
        <td>${entry.date}</td>
        <td>${entry.worked.toFixed(2)}</td>
        <td>${entry.regular.toFixed(2)}</td>
        <td>${entry.overtime.toFixed(2)}</td>
        <td>${entry.saturdayHrs.toFixed(2)}</td>
        <td>${entry.deduction.toFixed(2)}</td>
        <td>${entry.pay.toFixed(2)}</td>
        <td><button class="btn-delete" onclick="deleteEntry(${index})">Delete</button></td>
      </tr>`;
    }
    tbody.insertAdjacentHTML("beforeend",row);
  });

  document.getElementById("totalWorked").textContent=totals.worked.toFixed(2);
  document.getElementById("totalRegular").textContent=totals.regular.toFixed(2);
  document.getElementById("totalOvertime").textContent=totals.overtime.toFixed(2);
  document.getElementById("totalSaturday").textContent=totals.saturday.toFixed(2);
  document.getElementById("totalDeduction").textContent=totals.deduction.toFixed(2);
  document.getElementById("totalPay").textContent=totals.pay.toFixed(2);
}

renderLog();
</script>
</body>
</html>
